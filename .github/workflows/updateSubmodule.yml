
# ì„œë¸Œëª¨ë“ˆì—ì„œ ì›Œí¬í”Œë¡œìš° ë””ìŠ¤íŒ¨ì¹˜ ë˜ë„ë¡ í–ˆì„ ë•Œ (ì„œë¸Œëª¨ë“ˆì—ì„œ createWorkflowDispatch í˜¸ì¶œí–ˆì„ ë•Œ)
on:
  workflow_dispatch:
    inputs:
      name:
        description: 'Input name'
        required: true
        type: string
  
# ì‹¤í–‰ì¤‘ì¸ ë ˆí¬ì§€í† ë¦¬ì— ì“°ê¸° ê¶Œí•œ ë¶€ì—¬ (ì„œë¸Œëª¨ë“ˆì„ ìµœì‹ ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í›„ commit, push í•˜ê¸°ìœ„í•´ í•„ìš”)
permissions: write-all

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # í˜„ì¬ ë ˆí¬ì§€í† ë¦¬(í”„ë¡œì íŠ¸ ë©”ì¸ ë ˆí¬ì§€í† ë¦¬)ë¡œ ì²´í¬ì•„ì›ƒ
      # - name: Check out lokalise branch
      - uses: actions/checkout@v4
        with:
          submodules: true # ì„œë¸Œëª¨ë“ˆë„ í•¨ê»˜ ê°€ì ¸ì˜´
          token: ${{ secrets.KOCO_GITHUB_TOKEN }} # ì„œë¸Œëª¨ë“ˆì´ private ë ˆí¬ì¼ ê²½ìš° ì ‘ê·¼ì„ ìœ„í•´ í•„ìš”
      
      #ì„œë¸Œëª¨ë“ˆ ìµœì‹  ìƒíƒœë¡œ ì—…ë°ì´íŠ¸
      - name: Pull & update submodules recursively
        run: |
          git submodule update --init --recursive
          git submodule update --recursive --remote
            
      # ë³€ê²½ì‚¬í•­ ë©”ì¸ë ˆí¬ì— ì»¤ë°‹,í‘¸ì‹œ
      - name: Commit & push
        id: commit
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "[Success] complete update submodule"

      # ì„±ê³µ ì‹œ Slackì— ì•Œë¦¼
      - name: Notify Slack on Submodule Update Success
        if: steps.commit.outcome == 'success'
        uses: slackapi/slack-github-action@v2.0.0
        with:
          webhook: ${{ secrets.SLACK_WEBHOOK_URL }}
          webhook-type: webhook-trigger
          payload: |
            {
            "text": "ğŸ’ SubModule Update Success\n\nCommit: ${{ steps.commit.outputs.message }}"
            }
